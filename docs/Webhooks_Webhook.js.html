<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Webhooks/Webhook.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Webhooks/Webhook.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const fetch = require('node-fetch')
const { MessageEmbed } = require("discord.js")

/**
 * Represents a Discord Webhook
 */
class WebhookClient {
    constructor() {
        this.id = ""
        this.token = ""
    }

    /**
     * Initializes the WebhookClient
     * @param {Object} options An object containing the options to pass to the WebhookClient
     * @param {String} options.id The ID of the Webhook
     * @param {String} options.token The token of the Webhook
     * @returns {Boolean} Returns true if the client initiated successfully
     */
    init(options) {
        this.id = options.id
        this.token = options.token

        return true
    }

    /**
     * Sends a message on Discord via the WebhookClient
     * @param {Object|Array|String|MessageEmbed} message Webhook payload
     * @returns {Promise&lt;Response>}
     */
    send(message) {
        return new Promise((res, rej) => {

            var body = {
                content: "",
                embeds: [],
                tts: false
            }

            if (typeof message == "string") {
                body.content = message
            } else if (typeof message == 'object' &amp;&amp; !(message instanceof MessageEmbed) &amp;&amp; !(message instanceof Array)) {
                body = message
            } else if (message instanceof MessageEmbed) {
                console.log("embed")

                body.embeds.push(message.toJSON())
            } else if (message instanceof Array) {
                for (const msg of message) {
                    if (msg instanceof MessageEmbed) {
                        body.embeds.push(msg.toJSON())
                    } else if (typeof msg == "string") {
                        body.content = message.join(", ")
                    }
                }
            }

            console.log(body)

            fetch(`https://discord.com/api/webhooks/${this.id}/${this.token}`, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "User-Agent": "djs-tools",
                },

                body: JSON.stringify(body),
            })
                .then(requestCheck)
                .then(r => res(r))
                .catch(err => rej(err))
        })
    }
}

module.exports = WebhookClient

function requestCheck(res) {
    if (res.ok) {
        return res;
    } else {
        throw new Error(res.statusText);
    }
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="MusicPlayer.html">MusicPlayer</a></li><li><a href="SoundCloudClient.html">SoundCloudClient</a></li><li><a href="WebhookClient.html">WebhookClient</a></li><li><a href="YouTubeClient.html">YouTubeClient</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Wed May 19 2021 19:47:45 GMT-0500 (Central Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
